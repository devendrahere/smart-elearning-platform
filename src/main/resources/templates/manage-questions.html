<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Manage Questions - EduSmart</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Project CSS (moved from inline) -->
    <link th:href="@{/css/manage-questions.css}" rel="stylesheet" />
</head>

<body>

<th:block th:replace="~{fragments/header :: header}"></th:block>

<div class="container">

    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">
            <span>üìù</span>
            <span th:text="'Manage Questions for ' + ${quiz.quizTitle}"></span>
        </h1>
        <p class="page-subtitle">Create, update, and manage your quiz questions</p>
    </div>

    <!-- Main Card -->
    <div class="main-card">

        <!-- Questions Table -->
        <div class="table-container">
            <table class="table align-middle">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Question</th>
                    <th>Correct Option</th>
                    <th class="text-end">Actions</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="q, iter : ${questions}">
                    <td th:text="${iter.index + 1}"></td>
                    <td th:text="${q.questionText}"></td>
                    <td th:text="${q.correctOption}"></td>
                    <td class="text-end">

                        <form th:action="@{'/quiz/questions/delete/' + ${q.questionId}}"
                              method="post"
                              class="d-inline"
                              onsubmit="return confirm('Are you sure you want to delete this question?')">

                            <input type="hidden" th:name="quizId" th:value="${quiz.quizId}" />

                            <button class="btn btn-sm btn-danger btn-delete">üóë Delete</button>
                        </form>

                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <hr class="divider">

        <!-- Add Question Form -->
        <div class="form-section">
            <h2 class="section-title">‚ûï Add New Question</h2>

            <form th:action="@{/quiz/questions/add}" th:object="${newQuestion}" method="post">
                <input type="hidden" th:field="*{quizId}" />

                <div class="form-group mb-3">
                    <label>Question Text</label>
                    <input type="text" th:field="*{questionText}" placeholder="Enter the question" required />
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label>Option A</label>
                        <input type="text" th:field="*{optionA}" required />
                    </div>

                    <div class="col-md-6 mb-3">
                        <label>Option B</label>
                        <input type="text" th:field="*{optionB}" required />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label>Option C</label>
                        <input type="text" th:field="*{optionC}" required />
                    </div>

                    <div class="col-md-6 mb-3">
                        <label>Option D</label>
                        <input type="text" th:field="*{optionD}" required />
                    </div>
                </div>

                <div class="form-group mb-3">
                    <label>Correct Option</label>
                    <select th:field="*{correctOption}">
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                    </select>
                </div>

                <div class="text-end">
                    <button type="submit" class="btn-primary-custom mt-2">Add Question</button>
                </div>
            </form>
        </div>

        <!-- Back Button -->
        <div class="mt-4">
            <a th:href="@{'/courses/' + ${quiz.courseId} + '/lessons/manage'}" class="back-btn">‚Üê Back to Lessons</a>
        </div>

    </div>
</div>

<th:block th:replace="~{fragments/footer :: footer}"></th:block>

</body>
</html>